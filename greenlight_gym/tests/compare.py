
import numpy as np

def diff(a, b):
    return np.abs(a-b)

def get_error_idx(errors, tol=1e-10):
    return np.where(errors > tol)

correct_order = [0,1,2,3,4,5,9,6,7,8,10,11,12,13,14,15,16,19,21,20,22,17,23,24,25,26,27,18]

mat_x = np.array([802.719931388614,
802.719328461313,
16.5000088395616,
16.4999969465854,
20.4999764537516,
16.5000013861992,
16.5000457725561,
16.5000001850448,
16.5000035063998,
16.4998455457071,
16.4999997759421,
13.9911165795313,
11.4822330610372,
8.97334957405135,
6.46446609581771,
1681.90987895926,
1681.90957703445,
20.5000000000000,
730486.000000005,
16.5000154592327,
16.5000000000000,
16.5000000000000,
16.5000000000000,
-1.88451540385673e-06,
89999.9999902944,
249999.999988486,
279999.999990386,
3000.00000010350])
py_x = np.array([802.719931388617 ,
802.719328461313 ,
16.500008839561612 ,
16.499996946585433 ,
20.499976453751472 ,
16.50000138619923 ,
16.499845545706293 ,
16.500045772556316 ,
16.50000018504479 ,
16.500003506399803 ,
16.499999775942108 ,
13.991116579531289 ,
11.482233061037247 ,
8.97334957405135 ,
6.464466095817712 ,
1681.9098789592654 ,
1681.9095770344513 ,
16.500015459232774 ,
16.5 ,
16.5 ,
16.5 ,
20.5 ,
-1.8845154133243105e-06 ,
89999.99999029441 ,
249999.9999884864 ,
279999.99999038596 ,
3000.0000001035037 ,
730119.000000005])

mat_k = np.array([1.26932938510720,
-4.62004551160079e-11,
0.0210905565569178,
-0.00699950116878824,
-0.0727084971126440,
0.00312614813489841,
0.104923833506960,
0.000492637979109034,
0.00803791109903922,
-0.354009986349593,
-0.000513619913867949,
0.000128405012233770,
3.21012617037249e-05,
8.02531525235367e-06,
4.01265759653491e-06,
1.52463640391536,
-0.397184781766362,
-2.72524279104410e-10,
1.15740740740741e-05,
2.87190442547518,
1.14574589378376e-11,
0,
0,
0.287918649393647,
-0.0222486660023150,
-0.0263932590342253,
-0.0220388121756355,
0.000237266727475721])
py_k = np.array([1.3821232412272773 ,
4.235193217561528e-11 ,
0.020263244244807722 ,
-0.0069995017068503985 ,
-0.05397596853028752 ,
0.0031261481331727597 ,
-0.3540099951599298 ,
0.10492383351522816 ,
0.00042418583629340453 ,
0.008037911099039258 ,
-0.000513619913867949 ,
0.0001284050122337703 ,
3.210126170372497e-05 ,
8.025315252353663e-06 ,
4.012657596780635e-06 ,
0.29493443503127326 ,
-0.39718481150779444 ,
0.035436340575149286 ,
0.0 ,
1.1457429632839131e-11 ,
0.0 ,
-2.7252428046134013e-10 ,
-0.004319977802427671 ,
-0.022248666002314968 ,
-0.02639325903422534 ,
-0.022038812175635532 ,
0.00023726672747571953 ,
1.1574074074074073e-05 ,])

py_x = py_x[:-1]
py_k = py_k[:-1]

mat_x = mat_x[correct_order][:-1]
mat_k = mat_k[correct_order][:-1]

err_k = diff(mat_k,py_k)
err_x = diff(mat_x,py_x)

k_error_idx = get_error_idx(err_k)
x_error_idx = get_error_idx(err_x)

print("k error idx: ", k_error_idx)
# print("x2 error idx: ", x_error_idx)

# print("err_x: ", err_x)
print("err_k: ", err_k)